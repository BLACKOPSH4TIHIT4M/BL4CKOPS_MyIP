import{u as D,d as h,r as m,H as j,w as M,k as p,p as e,y as u,z as l,F as N,A as P,v as n,C as v,l as f,E as z,G as L}from"./vendor.DHFmOzci.js";import{u as R}from"./utils/utils-auth.Cj4TPQPL.js";import{g as q}from"./utils/utils-data.CC01m_V6.js";import{_ as B}from"./index-CuWL2HxC.js";import"./utils/utils-analytics.BMWz_Cy8.js";import"./utils/utils-getips.B2avacMe.js";import"./speedtest.Cf2juqOf.js";const $={class:"rule-test-section my-4"},F={class:"text-secondary"},V={class:"row"},G={class:"card-body"},H={class:"jn-con-title card-title"},U={class:"card-text text-secondary",style:{"font-size":"10pt"}},J=["data-bs-theme"],K=["disabled"],O={key:0},Q={key:1,class:"spinner-grow spinner-grow-sm bg-white","aria-hidden":"true"},X={__name:"RuleTest",setup(Y){const{t:s}=D(),c=R(),_=h(()=>c.isDarkMode),g=h(()=>c.isMobile),T=h(()=>c.lang),A=h(()=>c.isSignedIn),C=()=>({name:s("ruletest.Name"),ip:s("ruletest.StatusWait"),country_code:"",country:s("ruletest.StatusWait")}),o=m(Array.from({length:8},(r,a)=>({id:a+1,url:`ptest-${a+1}.ipcheck.ing`,...C()}))),y=m([]),b=m(o.value.length),d=m(!1),x=async(r,a)=>{try{const k=(await(await fetch(`https://${a}/cdn-cgi/trace`)).text()).split(`
`),W=k.find(i=>i.startsWith("ip=")),E=k.find(i=>i.startsWith("loc="));if(W){const i=W.split("=")[1];o.value[r].ip=i,y.value=[...y.value,i]}if(E){const i=E.split("=")[1];o.value[r].country_code=i,o.value[r].country=q(i,T.value)}}catch(t){o.value[r].ip=s("ruletest.StatusError"),o.value[r].country_code="",o.value[r].country=s("ruletest.StatusError"),console.error("Error fetching Data:",t)}},S=async(r=!1)=>{d.value=!1,r&&o.value.forEach(t=>{t.ip=s("ruletest.StatusWait"),t.country=s("ruletest.StatusWait"),t.country_code=""});const a=async t=>{if(t<b.value)try{await x(t,o.value[t].url)}catch(w){console.error("Error fetching Data:",w)}finally{a(t+1),t===b.value-1&&(d.value=!0,A.value&&I())}};a(0)},I=()=>{const r=o.value.map(t=>t.ip);[...new Set(r)].length===8&&(c.userAchievements.CrossingTheWall.achieved||c.setTriggerUpdateAchievements("CrossingTheWall"))};return j(()=>{setTimeout(()=>{S()},1e3)}),M(y,()=>{c.updateAllIPs(y.value)},{deep:!0}),(r,a)=>(f(),p("div",null,[e("div",$,[e("div",F,[e("p",null,u(l(s)("ruletest.Note")),1)]),e("div",V,[(f(!0),p(N,null,P(o.value,t=>(f(),p("div",{key:t.id,class:"col-lg-3 col-md-6 col-12 mb-4"},[e("div",{class:n(["card jn-card",{"dark-mode dark-mode-border":_.value,"jn-hover-card":!g.value}])},[e("div",G,[e("p",H,[a[1]||(a[1]=e("i",{class:"bi bi-signpost-split-fill"},null,-1)),v(" "+u(t.name)+" ",1),e("i",{class:n(["bi","bi-"+t.id+"-square"])},null,2),a[2]||(a[2]=v("  ",-1))]),e("p",U,[a[3]||(a[3]=e("i",{class:"bi bi-hdd-network-fill"},null,-1)),v(" "+u(t.url),1)]),e("p",{class:n(["card-text",{"text-info":t.ip===l(s)("ruletest.StatusWait"),"text-success":t.ip.includes(".")||t.ip.includes(":"),"text-danger":t.ip===l(s)("ruletest.StatusError")}])},[e("i",{class:n(["bi",[t.ip===l(s)("ruletest.StatusWait")?"bi-hourglass-split":"bi-pc-display-horizontal"]])}," ",2),e("span",{class:n({"jn-ip-font":t.ip.length>32})},u(t.ip),3)],2),e("div",{class:n(["alert",{"alert-info":t.country===l(s)("ruletest.StatusWait"),"alert-danger":t.country===l(s)("ruletest.StatusError"),"alert-success":t.country!==l(s)("ruletest.StatusWait")&&t.country!==l(s)("ruletest.StatusError")}]),"data-bs-theme":_.value?"dark":""},[e("i",{class:n(["bi",[t.ip===l(s)("ruletest.StatusWait")||t.ip===l(s)("ruletest.StatusError")?"bi-hourglass-split":"bi-geo-alt-fill"]])},null,2),v(" "+u(l(s)("ruletest.Country"))+": ",1),e("strong",null,u(t.country)+" ",1),z(e("span",{class:n("jn-fl fi fi-"+t.country_code.toLowerCase())},null,2),[[L,t.country_code]])],10,J)])],2)]))),128)),e("div",{class:n(["flex justify-content-center col-12",[g.value?"":"text-center mt-4"]])},[e("button",{class:n(["btn",[d.value?"btn-success":"btn-info",g.value?"w-100":"w-25"]]),disabled:!d.value,onClick:a[0]||(a[0]=t=>S(!0))},[d.value?(f(),p("span",O,[a[4]||(a[4]=e("i",{class:"bi bi-arrow-clockwise"},null,-1)),v(" "+u(l(s)("ruletest.RefreshAll")),1)])):(f(),p("span",Q))],10,K)],2)])])]))}},ot=B(X,[["__scopeId","data-v-5f730315"]]);export{ot as default};
