import{r as m,d as P,k as a,p as e,s as i,E as R,O as I,P as F,y as n,F as b,A as g,l}from"./vendor.DHFmOzci.js";import{u as O}from"./utils/utils-auth.Cj4TPQPL.js";import{_ as V}from"./index-CuWL2HxC.js";import"./utils/utils-analytics.BMWz_Cy8.js";import"./utils/utils-getips.B2avacMe.js";import"./utils/utils-data.CC01m_V6.js";import"./speedtest.Cf2juqOf.js";const C={class:"card"},H={class:"card-body"},L={class:"input-group mb-3"},$=["disabled"],j=["disabled"],D={key:0,class:"alert alert-warning"},K={key:1,class:"text-muted"},M={key:2,class:"alert alert-danger"},N={key:3},S={class:"small",style:{"white-space":"pre-wrap"}},U={key:4},z={class:"table table-sm table-bordered"},A={key:5,class:"mt-3"},W={class:"d-flex align-items-center path-visual"},q={class:"node-name"},G={class:"node-lat"},J={key:0,class:"node-arrow"},Q={__name:"Traceroute",setup(X){const d=m(""),p=m(!1),u=m(null),c=m(""),o=m([]),w=O(),f=P(()=>w.configs?.traceroute);async function _(){if(!f.value){u.value="Traceroute is disabled on this server";return}if(d.value){p.value=!0,u.value=null,c.value="",o.value=[];try{const r=await fetch(`/api/traceroute?target=${encodeURIComponent(d.value)}`,{headers:{Referer:window.location.origin}});if(!r.ok)throw r.status===429?new Error("Rate limit exceeded. Try again later."):new Error(`HTTP ${r.status}`);const t=await r.json();t.error?u.value=t.error:(c.value=t.raw||t.rawOutput||"",o.value=x(c.value))}catch(r){console.error("Traceroute failure",r),u.value=r.message||"Failed to run traceroute"}finally{p.value=!1}}}function x(r){return r?r.split(/\r?\n/).filter(Boolean).map(h=>{const v=h.match(/^(\d+)\s+(.*?)\s+(?:\((\d+\.\d+\.\d+\.\d+)\))?\s*(.*)$/);if(!v)return null;const T=parseInt(v[1],10),y=v[2].trim(),B=v[3]||y.match(/(\d+\.\d+\.\d+\.\d+)/)?.[0]||"",E=v[4]?.trim()||"";return{index:T,host:y,ip:B,times:E}}).filter(Boolean):[]}function k(r){return r&&r.split(/\s+/).filter(Boolean).find(s=>s.endsWith("ms"))||""}return(r,t)=>(l(),a("div",C,[e("div",H,[t[5]||(t[5]=e("h5",{class:"card-title"},"Traceroute",-1)),t[6]||(t[6]=e("p",{class:"card-text"},"Enter a host or IP to traceroute from the server.",-1)),e("div",L,[R(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),class:"form-control",placeholder:"example.com or 8.8.8.8",onKeyup:F(_,["enter"]),disabled:!f.value},null,40,$),[[I,d.value]]),e("button",{class:"btn btn-primary",disabled:p.value||!d.value||!f.value,onClick:_},"Run",8,j)]),f.value?i("",!0):(l(),a("div",D,"Traceroute is disabled on this server")),p.value?(l(),a("div",K,"Running traceroute…")):i("",!0),u.value?(l(),a("div",M,n(u.value),1)):i("",!0),c.value?(l(),a("div",N,[t[1]||(t[1]=e("h6",{class:"mt-2"},"Raw Output",-1)),e("pre",S,n(c.value),1)])):i("",!0),o.value&&o.value.length?(l(),a("div",U,[t[3]||(t[3]=e("h6",{class:"mt-2"},"Parsed Hops",-1)),e("table",z,[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Host"),e("th",null,"IP"),e("th",null,"Times")])],-1)),e("tbody",null,[(l(!0),a(b,null,g(o.value,s=>(l(),a("tr",{key:s.index},[e("td",null,n(s.index),1),e("td",null,n(s.host),1),e("td",null,n(s.ip),1),e("td",null,n(s.times),1)]))),128))])])])):i("",!0),o.value&&o.value.length?(l(),a("div",A,[t[4]||(t[4]=e("h6",null,"Path Visualization",-1)),e("div",W,[(l(!0),a(b,null,g(o.value,(s,h)=>(l(),a("div",{key:s.index,class:"path-node text-center"},[e("div",q,n(s.host||s.ip),1),e("div",G,n(k(s.times)),1),h<o.value.length-1?(l(),a("div",J,"→")):i("",!0)]))),128))])])):i("",!0)])]))}},le=V(Q,[["__scopeId","data-v-09f5f7ef"]]);export{le as default};
