import{u as y}from"./utils/utils-auth.Cj4TPQPL.js";import{_}from"./index-CuWL2HxC.js";import{r as f,d as k,k as o,p as e,s as d,y as l,F as b,A as g,l as a,v as C}from"./vendor.DHFmOzci.js";import"./utils/utils-analytics.BMWz_Cy8.js";import"./utils/utils-getips.B2avacMe.js";import"./utils/utils-data.CC01m_V6.js";import"./speedtest.Cf2juqOf.js";const S={class:"card"},I={class:"card-body"},w={class:"mb-2"},P=["disabled"],E={key:0,class:"small text-muted ms-2"},A={key:0,class:"alert alert-warning"},L={key:1,class:"alert alert-danger"},N={key:2},x={class:"table table-sm table-bordered"},R={class:"table table-sm table-bordered"},T={__name:"ConnectionInfo",setup(B){const u=f(!1),r=f(null),i=f(null),m=y(),c=k(()=>m.configs?.connInfo);async function v(){u.value=!0,r.value=null,i.value=null;try{if(!c.value){r.value="Connection info is disabled on this server",u.value=!1;return}const s=await fetch("/api/conn-info",{headers:{Referer:window.location.origin}});if(!s.ok)throw s.status===429?new Error("Rate limit exceeded. Try again later."):new Error(`HTTP ${s.status}`);const n=await s.json();n.error?r.value=n.error||JSON.stringify(n):i.value=n}catch(s){console.error("fetchConnInfo failed",s),r.value=s.message||"Failed to fetch connection info"}finally{u.value=!1}}function h(s){if(!s)return"badge bg-secondary";const n=s.toString().toUpperCase();return n.includes("ESTABLISHED")?"badge bg-success":n.includes("LISTEN")?"badge bg-primary":n.includes("CLOSE")?"badge bg-danger":n.includes("SYN")?"badge bg-warning text-dark":"badge bg-secondary"}return v(),(s,n)=>(a(),o("div",S,[e("div",I,[n[5]||(n[5]=e("h5",{class:"card-title"},"Connection Info",-1)),n[6]||(n[6]=e("p",{class:"card-text"},"View listening sockets, established connections, and LAN neighbors (ARP table).",-1)),e("div",w,[e("button",{class:"btn btn-outline-primary btn-sm",disabled:u.value||!c.value,onClick:v},"Refresh",8,P),u.value?(a(),o("span",E,"Loadingâ€¦")):d("",!0)]),c.value?d("",!0):(a(),o("div",A,"Connection info is disabled on this server")),r.value?(a(),o("div",L,l(r.value),1)):d("",!0),i.value?(a(),o("div",N,[n[2]||(n[2]=e("h6",null,"Host IPs",-1)),e("ul",null,[(a(!0),o(b,null,g(i.value.hostIPs,t=>(a(),o("li",{key:t.ip},[e("code",null,l(t.iface)+": "+l(t.ip),1)]))),128))]),n[3]||(n[3]=e("h6",null,"Open Sockets / Connections (sample)",-1)),e("table",x,[n[0]||(n[0]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Local"),e("th",null,"Peer"),e("th",null,"State"),e("th",null,"Proc")])],-1)),e("tbody",null,[(a(!0),o(b,null,g(i.value.sockets,(t,p)=>(a(),o("tr",{key:p},[e("td",null,l(p+1),1),e("td",null,l(t.local||t.Local),1),e("td",null,l(t.peer||t["Peer Address:Port"]||t.foreign||t.foreignAddress),1),e("td",null,[e("span",{class:C(h(t.state||t.State))},l(t.state||t.State),3)]),e("td",null,l(t.proc||t.PROCESS||""),1)]))),128))])]),n[4]||(n[4]=e("h6",null,"Neighbors / ARP Table",-1)),e("table",R,[n[1]||(n[1]=e("thead",null,[e("tr",null,[e("th",null,"IP"),e("th",null,"MAC"),e("th",null,"Device"),e("th",null,"State/Flags")])],-1)),e("tbody",null,[(a(!0),o(b,null,g(i.value.neighbors,t=>(a(),o("tr",{key:t.ip},[e("td",null,l(t.ip),1),e("td",null,l(t.mac||""),1),e("td",null,l(t.dev||t.devic||t.dev||""),1),e("td",null,l(t.state||t.flags||""),1)]))),128))])])])):d("",!0)])]))}},z=_(T,[["__scopeId","data-v-94fbde56"]]);export{z as default};
